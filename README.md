# CleanArchitectureSample

안드로이드 클린 아키텍처 샘플

MVVM + Retrofit + Room + Hilt



<br/><br/>

## 구성의도
<br/>

- UI, 데이터베이스, 프레임워크 등의 독립성 (결합도 down)
- 기능 변경 및 확장의 용이성 (유지보수의 용이성)
- 테스트 용이성

<br/><br/>

## 계층 구조
<br/><br/>

<p align="center">
<img src="https://user-images.githubusercontent.com/63940434/224923224-28840e2a-e09b-4ce4-a170-5891ef741052.png"  width="400" height="500">
</p>


- **엔티티(노랑색)** : 엔티티는 전사적인 핵심 업무 규칙을 캡슐화 한다. 즉, 모든 플랫폼 애플리케이션에서 재사용 가능해야 한다. 외부의 무언가가 변경되어도 엔티티가 변경될 가능성은 낮다.
- **유즈케이스(빨강색)** : 애플리케이션에 특화된 업무 규칙을 포함한다. 유즈케이스는 엔티티로 들어오고 나가는 데이터의 흐름을 조정하며, 엔티티가 자신의 핵심 업무 규칙을 사용해서 유즈케이스의 목적을 달성하도록 한다. 변경사항이 엔터티에 영향을 줘서는 안되며, UI 또는 프레임워크 등과 같은 외부요소에서 발생한 변경이 이 계층에 영향을 줘서도 안된다.
- **인터페이스 어댑터(녹색)** : 인터페이스 어댑터 계층은 일련의 어댑터들로 구성된다. 여기서 어댑터가 하는 역할은 상대적으로 상위 계층인 유즈케이스 그리고 프레임워크와 같은 하위 계층간의 중간다리 역할을 하며 서로가 가장 편리한 형식으로 변환을 한다. 흔히 MVP, MVVM 같은 아키텍처가 여기에 속한다.
- **프레임워크(파랑색)** : 안드로이드 프레임워크를 의미 한다. 일반적인 앱 개발자는 이 영역에서 작성할 코드는 거의 없다. 하지만, 구글이 새로운 안드로이드 프레임워크를 배포할 때 변경사항이 발생하므로 우리는 안드로이드 프레임워크를 가장 외부에 위치시켜서 피해를 최소화해야 한다.

<br/><br/>

## 계층간 의존성 규칙
<br/>

### Presentation

domain, data 모듈에 의존한다. 프레젠테이션 계층은 UI와 관련된 코드를 캡슐화한다. 모든 UI와 관련된 컴포넌트 또는 안드로이드 프레임워크와 관련된 코드들을 이 계층에서 다루게 된다.

UI 코드를 한 곳에서 관리함으로써 비즈니스 로직을 보호하고, 테스트도 쉽게 만든다.

### Domain

domain 모듈은 앱의 중심부로써 이 계층에 포함된 비즈니스 로직은 앱을 구성하고 있는 것 중 가장 중요한 부분이다. 그래서 비즈니스 로직을 망쳐서는 안되기 때문에 이 계층은 어떠한 계층에도 의존하지 않는다.

- Entity : 특정 영역을 표현하는 객체. ex) Pojo, VO, DTO 등
- UseCase : Entity와 함께 비즈니스 로직을 수행한다.
- Repository 인터페이스 : 데이터베이스, 원격 서버와 같은 데이터 소스에 접근한다.

### Data

data 모듈은 데이터 소스(DB, 서버 등)와 상호작용을 담당하는 코드가 포함되는 곳이다. 
data 모듈은 domain 모듈에 의존한다.

- 데이터 입출력 코드를 하나의 계층에서 관리한다.
- 데이터 소스들과 데이터를 소비하는 다른 계층과의 경계를 둔다.

<br/><br/>

**Entity** : 변경이 되서는 안되는 Data Class. 가장 기본이 되는 Data Class 로 Api 에서 내려오는 데이터 형식이 바뀌어도 Entity 는 영향이 없도록 해야한다. 
즉, 변경가능성이 높은 API 같은 경우에는 Entity 가 아니라 DTO 라고 생각해야 한다.
DB 입장에서는 해당 값들이 변경되면 안되는 값들이기 때문에 Entity 로 어노테이션을 선언하여 사용한다.

**DTO** : 변경이 쉽게 가능한 Data Class. 데이터 형태나 구조가 바뀔 수 있는 경우 사용하는 Data Class.      DTO 를 가공하여 Entity 에 넣어 사용하기 때문에, 실제로 사용하는 데이터가 변경되지 않는 이상 다른 구조에 영향이 없다.

**Mapper** : Data Entity to Data Model
Data Layer 에서는 Data Entity 로 받아서 사용하지만, Domain, Presentation Layer 에서는 
Data Model 로 사용한다.
즉, Mapper 는 Data Layer 에 존재하면서 다른 계층으로 Data 를 전달할 때, 사용하는 Data Model 에 맞춰서 변환하여 던지는 역할.

<br/><br/>




## Flow

<br/>

<img src="https://user-images.githubusercontent.com/63940434/224923842-94401102-2d94-42ed-9328-4f8eca8f331c.png">
<br/>
<img src="https://user-images.githubusercontent.com/63940434/224923852-6f2ee412-1b7f-4be9-b5ca-d7769ff1a332.png">
